# Telegram-бот для поиска вакансий на hh.ru

## Описание проекта

Telegram-бот, который ищет вакансии на hh.ru по индивидуальным фильтрам пользователя, ежедневно присылает новые вакансии и позволяет генерировать адаптированное резюме и сопроводительное письмо через LLM.

## Функциональность

### Основные возможности

- Регистрация пользователей через команду `/start`
- Настройка фильтров поиска вакансий (`/search_settings`)
- Ежедневная рассылка новых вакансий
- Просмотр вакансий с возможностью генерации резюме и сопроводительных писем (`/vacancies`)
- Настройка профиля пользователя (`/my_profile`)
- Настройка параметров LLM для генерации документов (`/llm_settings`)

### Команды бота

- `/start` - регистрация и приветствие
- `/search_settings` - настройка фильтров поиска
- `/set_position` - установить желаемую должность
- `/set_city` - установить город
- `/set_min_salary` - установить минимальную зарплату
- `/set_employment` - установить тип занятости
- `/set_experience` - установить требуемый опыт
- `/vacancies` - просмотр вакансий
- `/my_profile` - просмотр и редактирование профиля
- `/update_city` - обновить город
- `/update_position` - обновить желаемую должность
- `/update_skills` - обновить навыки
- `/update_resume` - обновить базовое резюме
- `/llm_settings` - настройка параметров LLM
- `/set_llm_url` - установить URL для LLM API
- `/set_llm_key` - установить API ключ
- `/set_llm_model` - установить модель

## Установка и запуск

### Требования

- Python 3.11+
- PostgreSQL (для хранения данных)

### Установка

1. Клонируйте репозиторий:
   ```bash
   git clone <url_репозитория>
   cd hh-bot
   ```

2. Создайте виртуальное окружение:
   ```bash
   python -m venv venv
   source venv/bin/activate  # На Windows: venv\Scripts\activate
   ```

3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

4. Создайте файл `.env` на основе `.env.example` и укажите свои значения:
   ```bash
   cp .env.example .env
   ```

5. Настройте переменные окружения в файле `.env`:
   - `BOT_TOKEN` - токен вашего Telegram-бота
   - `DATABASE_URL` - строка подключения к базе данных PostgreSQL
   - `HH_CLIENT_ID` и `HH_CLIENT_SECRET` - для работы с HH API (опционально)
   - `LLM_BASE_URL`, `LLM_API_KEY`, `LLM_MODEL_NAME` - для генерации документов через LLM

6. Инициализируйте базу данных:
   ```bash
   python -m bot.db.init_db
   ```

7. Запустите бота:
   ```bash
   python main.py
   ```

## Структура проекта

```
hh-bot/
├── main.py                 # Основной файл запуска бота
├── requirements.txt        # Зависимости проекта
├── .env.example           # Пример файла переменных окружения
├── README.md              # Документация проекта
├── bot/                   # Основной модуль бота
│   ├── config.py          # Конфигурация приложения
│   ├── db/                # Работа с базой данных
│   │   ├── models.py      # Модели базы данных
│   │   ├── database.py    # Подключение к базе данных
│   │   └── init_db.py     # Инициализация базы данных
│   ├── handlers/          # Обработчики команд бота
│   ├── services/          # Внешние сервисы (HH API, LLM)
│   └── utils/             # Вспомогательные утилиты
└── tests/                 # Тесты проекта
```

## Используемые технологии

- Python 3.11+
- aiogram 4.12.0 - фреймворк для создания Telegram-ботов
- PostgreSQL - реляционная база данных
- SQLAlchemy - ORM для работы с базой данных
- Requests - для HTTP-запросов к API
- Pydantic - валидация данных
- APScheduler - планировщик задач для ежедневной рассылки
- OpenAI API (или совместимый) - для генерации резюме и сопроводительных писем

## Технические особенности

- Асинхронная архитектура с использованием asyncio
- Интеграция с HH API для поиска вакансий
- Возможность генерации адаптированных резюме и сопроводительных писем с помощью LLM
- Система фильтров для персонализированного поиска вакансий
- Ежедневная автоматическая рассылка новых вакансий пользователям
- Хранение истории взаимодействия с вакансиями (просмотр, генерация документов)

## Авторы

Проект разработан в рамках образовательного проекта.

## 1. Цель проекта

Создать Telegram-бота, который ищет вакансии на hh.ru по индивидуальным фильтрам пользователя, ежедневно присылает новые вакансии и позволяет генерировать адаптированное резюме и сопроводительное письмо через LLM.

---

## 2. Основной функционал

### 2.1. Регистрация пользователя

- `/start` создаёт профиль.
- Сохраняются: telegram_id, фио, город, желаемая должность, навыки, базовое резюме.

### 2.2. Настройки поиска

- `/search_settings`
- Пользователь указывает:
  - желаемая должность;
  - город;
  - минимальную зарплату;
  - удалённость (выбрать подходящие станции метро)
  - «свежесть» вакансий (1–3 дня).
  - Тип занятости (Полная занятость, Частичная, Удаленная)
  - Опыт работы (нет опыта, 1-3 года, 3-6 лет, более 6 лет)
  - Компания (Только прямые работодатели, Размер компании: малая/средняя/крупная, Только ТОП-компании)

### 2.3. Ежедневная рассылка

- Раз в сутки:
  - берутся фильтры каждого пользователя;
  - вызывается API hh.ru;
  - новые вакансии сохраняются;
  - пользователю отправляется подборка (5–10 позиций).

### 2.4. Просмотр вакансий

- `/vacancies`
- Каждая вакансия: название, компания, город, зарплата, ссылка.
- Кнопки под вакансией:
  - «Сгенерировать резюме»
  - «Сгенерировать cover letter»
  - «Неинтересно»

### 2.5. Генерация документов

- Пользователь задаёт свой LLM API:
  - Base URL
  - API Key
  - название модели
- Бот генерирует:
  - адаптированное резюме;
  - сопроводительное письмо.
- Сохраняет и отправляет пользователю.

---

## 3. Технические требования

### 3.1. Технологии

- Python 3.11+
- aiogram
- PostgreSQL (Neon)
- Асинхронный HTTP-клиент
- OpenAI-совместимый LLM endpoint

### 3.2. Архитектура

- Модули:
  - handlers
  - hh_service
  - llm_service
  - db
  - scheduler (cron/apscheduler)

### 3.3. Хранимые данные

- Пользователи
- Поисковые фильтры
- Настройки LLM
- Вакансии
- Связки «пользователь ↔ вакансия»
- Сгенерированные документы

---

## 4. Нефункциональные требования

- Логирование без утечки секретов.
- Исключение повторной рассылки тех же вакансий.
- Стабильная обработка ошибок hh.ru и LLM.
- Чистая архитектура, читаемый код.
- README и пример `.env`.
