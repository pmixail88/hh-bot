2025-11-25 11:09:05 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-11-25 11:09:05 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-11-25 11:09:06 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-11-25 11:09:06 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-11-25 11:09:06 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-11-25 11:09:06 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-11-25 11:09:06 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-11-25 11:09:06 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-11-25 11:09:06 - bot.db.init_db - INFO - Database tables created successfully
2025-11-25 11:09:07 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-25 11:09:07 - apscheduler.scheduler - INFO - Added job "Проверка новых вакансий" to job store "default"
2025-11-25 11:09:07 - apscheduler.scheduler - INFO - Scheduler started
2025-11-25 11:09:07 - __main__ - INFO - Бот запускается...
2025-11-25 11:09:07 - aiogram.dispatcher - INFO - Start polling
2025-11-25 11:09:07 - aiogram.dispatcher - INFO - Run polling for bot @HH_work_day_bot id=7721173847 - 'HH_work_day_bot'
2025-11-25 11:09:23 - bot.handlers.start_handler - INFO - Пользователь Михаил Павлов (ID: 938253913) запустил бота
2025-11-25 11:09:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-11-25 11:09:23 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.telegram_id AS users_telegram_id, users.full_name AS users_full_name, users.city AS users_city, users.desired_position AS users_desired_position, users.skills AS users_skills, users.base_resume AS users_base_resume, users.created_at AS users_created_at, users.is_active AS users_is_active 
FROM users 
WHERE users.telegram_id = %(telegram_id_1)s 
 LIMIT %(param_1)s
2025-11-25 11:09:23 - sqlalchemy.engine.Engine - INFO - [generated in 0.00320s] {'telegram_id_1': '938253913', 'param_1': 1}
2025-11-25 11:09:24 - bot.handlers.start_handler - INFO - Пользователь 938253913 уже существует в базе данных
2025-11-25 11:09:24 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-11-25 11:09:24 - aiogram.event - INFO - Update id=587740986 is handled. Duration 1422 ms by bot id=7721173847
2025-11-25 11:09:29 - bot.handlers.start_handler - INFO - Пользователь 938253913 нажал кнопку 'Настроить поиск'
2025-11-25 11:09:29 - bot.handlers.search_settings_handler - INFO - Пользователь 938253913 запросил команду /search_settings
2025-11-25 11:09:30 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-11-25 11:09:30 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.telegram_id AS users_telegram_id, users.full_name AS users_full_name, users.city AS users_city, users.desired_position AS users_desired_position, users.skills AS users_skills, users.base_resume AS users_base_resume, users.created_at AS users_created_at, users.is_active AS users_is_active 
FROM users 
WHERE users.telegram_id = %(telegram_id_1)s 
 LIMIT %(param_1)s
2025-11-25 11:09:30 - sqlalchemy.engine.Engine - INFO - [cached since 6.348s ago] {'telegram_id_1': '938253913', 'param_1': 1}
2025-11-25 11:09:30 - sqlalchemy.engine.Engine - INFO - SELECT search_filters.id AS search_filters_id, search_filters.user_id AS search_filters_user_id, search_filters.position AS search_filters_position, search_filters.city AS search_filters_city, search_filters.min_salary AS search_filters_min_salary, search_filters.metro_stations AS search_filters_metro_stations, search_filters.freshness_days AS search_filters_freshness_days, search_filters.employment_types AS search_filters_employment_types, search_filters.experience_level AS search_filters_experience_level, search_filters.only_direct_employers AS search_filters_only_direct_employers, search_filters.company_size AS search_filters_company_size, search_filters.only_top_companies AS search_filters_only_top_companies, search_filters.created_at AS search_filters_created_at, search_filters.is_active AS search_filters_is_active 
FROM search_filters 
WHERE search_filters.user_id = %(user_id_1)s AND search_filters.is_active = true 
 LIMIT %(param_1)s
2025-11-25 11:09:30 - sqlalchemy.engine.Engine - INFO - [generated in 0.00513s] {'user_id_1': 4, 'param_1': 1}
2025-11-25 11:09:30 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-11-25 11:09:30 - aiogram.event - INFO - Update id=587740987 is handled. Duration 922 ms by bot id=7721173847
2025-11-25 11:09:59 - aiogram.event - INFO - Update id=587740988 is handled. Duration 296 ms by bot id=7721173847
2025-11-25 11:10:10 - bot.handlers.start_handler - INFO - Пользователь 938253913 нажал кнопку 'Главная'
2025-11-25 11:10:10 - bot.handlers.start_handler - INFO - Пользователь Михаил Павлов (ID: 938253913) запустил бота
2025-11-25 11:10:10 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-11-25 11:10:10 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.telegram_id AS users_telegram_id, users.full_name AS users_full_name, users.city AS users_city, users.desired_position AS users_desired_position, users.skills AS users_skills, users.base_resume AS users_base_resume, users.created_at AS users_created_at, users.is_active AS users_is_active 
FROM users 
WHERE users.telegram_id = %(telegram_id_1)s 
 LIMIT %(param_1)s
2025-11-25 11:10:10 - sqlalchemy.engine.Engine - INFO - [cached since 47.24s ago] {'telegram_id_1': '938253913', 'param_1': 1}
2025-11-25 11:10:11 - bot.handlers.start_handler - INFO - Пользователь 938253913 уже существует в базе данных
2025-11-25 11:10:11 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-11-25 11:10:11 - aiogram.event - INFO - Update id=587740989 is handled. Duration 750 ms by bot id=7721173847
2025-11-25 11:10:15 - bot.handlers.start_handler - INFO - Пользователь 938253913 нажал кнопку 'Просмотр вакансий'
2025-11-25 11:10:15 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-11-25 11:10:15 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.telegram_id AS users_telegram_id, users.full_name AS users_full_name, users.city AS users_city, users.desired_position AS users_desired_position, users.skills AS users_skills, users.base_resume AS users_base_resume, users.created_at AS users_created_at, users.is_active AS users_is_active 
FROM users 
WHERE users.telegram_id = %(telegram_id_1)s 
 LIMIT %(param_1)s
2025-11-25 11:10:15 - sqlalchemy.engine.Engine - INFO - [cached since 52.02s ago] {'telegram_id_1': '938253913', 'param_1': 1}
2025-11-25 11:10:15 - sqlalchemy.engine.Engine - INFO - SELECT search_filters.id AS search_filters_id, search_filters.user_id AS search_filters_user_id, search_filters.position AS search_filters_position, search_filters.city AS search_filters_city, search_filters.min_salary AS search_filters_min_salary, search_filters.metro_stations AS search_filters_metro_stations, search_filters.freshness_days AS search_filters_freshness_days, search_filters.employment_types AS search_filters_employment_types, search_filters.experience_level AS search_filters_experience_level, search_filters.only_direct_employers AS search_filters_only_direct_employers, search_filters.company_size AS search_filters_company_size, search_filters.only_top_companies AS search_filters_only_top_companies, search_filters.created_at AS search_filters_created_at, search_filters.is_active AS search_filters_is_active 
FROM search_filters 
WHERE search_filters.user_id = %(user_id_1)s AND search_filters.is_active = true 
 LIMIT %(param_1)s
2025-11-25 11:10:15 - sqlalchemy.engine.Engine - INFO - [cached since 45.66s ago] {'user_id_1': 4, 'param_1': 1}
2025-11-25 11:10:16 - sqlalchemy.engine.Engine - INFO - SELECT vacancies.id AS vacancies_id, vacancies.hh_id AS vacancies_hh_id, vacancies.title AS vacancies_title, vacancies.company AS vacancies_company, vacancies.city AS vacancies_city, vacancies.salary_from AS vacancies_salary_from, vacancies.salary_to AS vacancies_salary_to, vacancies.salary_currency AS vacancies_salary_currency, vacancies.description AS vacancies_description, vacancies.url AS vacancies_url, vacancies.published_at AS vacancies_published_at, vacancies.employer_id AS vacancies_employer_id, vacancies.created_at AS vacancies_created_at 
FROM vacancies JOIN user_vacancies ON vacancies.id = user_vacancies.vacancy_id 
WHERE user_vacancies.user_id = %(user_id_1)s AND (user_vacancies.viewed_at < %(viewed_at_1)s OR user_vacancies.viewed_at IS NULL) 
 LIMIT %(param_1)s
2025-11-25 11:10:16 - sqlalchemy.engine.Engine - INFO - [generated in 0.00250s] {'user_id_1': 4, 'viewed_at_1': datetime.datetime(2025, 11, 24, 8, 10, 16, 94497), 'param_1': 5}
2025-11-25 11:10:17 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-11-25 11:10:18 - aiogram.event - INFO - Update id=587740990 is handled. Duration 2531 ms by bot id=7721173847
2025-11-25 11:10:20 - bot.handlers.start_handler - INFO - Пользователь 938253913 нажал кнопку 'Мой профиль'
2025-11-25 11:10:20 - bot.handlers.profile_handler - INFO - Пользователь 938253913 запросил команду /my_profile
2025-11-25 11:10:20 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-11-25 11:10:20 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.telegram_id AS users_telegram_id, users.full_name AS users_full_name, users.city AS users_city, users.desired_position AS users_desired_position, users.skills AS users_skills, users.base_resume AS users_base_resume, users.created_at AS users_created_at, users.is_active AS users_is_active 
FROM users 
WHERE users.telegram_id = %(telegram_id_1)s 
 LIMIT %(param_1)s
2025-11-25 11:10:20 - sqlalchemy.engine.Engine - INFO - [cached since 57.23s ago] {'telegram_id_1': '938253913', 'param_1': 1}
2025-11-25 11:10:21 - bot.handlers.profile_handler - INFO - Профиль пользователя 938253913 успешно отправлен
2025-11-25 11:10:21 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-11-25 11:10:21 - aiogram.event - INFO - Update id=587740991 is handled. Duration 922 ms by bot id=7721173847
2025-11-25 11:10:31 - bot.handlers.start_handler - INFO - Пользователь 938253913 нажал кнопку 'Главная'
2025-11-25 11:10:31 - bot.handlers.start_handler - INFO - Пользователь Михаил Павлов (ID: 938253913) запустил бота
2025-11-25 11:10:31 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-11-25 11:10:31 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.telegram_id AS users_telegram_id, users.full_name AS users_full_name, users.city AS users_city, users.desired_position AS users_desired_position, users.skills AS users_skills, users.base_resume AS users_base_resume, users.created_at AS users_created_at, users.is_active AS users_is_active 
FROM users 
WHERE users.telegram_id = %(telegram_id_1)s 
 LIMIT %(param_1)s
2025-11-25 11:10:31 - sqlalchemy.engine.Engine - INFO - [cached since 67.98s ago] {'telegram_id_1': '938253913', 'param_1': 1}
2025-11-25 11:10:31 - bot.handlers.start_handler - INFO - Пользователь 938253913 уже существует в базе данных
2025-11-25 11:10:32 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-11-25 11:10:32 - aiogram.event - INFO - Update id=587740992 is handled. Duration 828 ms by bot id=7721173847
2025-11-25 11:10:34 - bot.handlers.start_handler - INFO - Пользователь 938253913 нажал кнопку 'Настройки LLM'
2025-11-25 11:10:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-11-25 11:10:34 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.telegram_id AS users_telegram_id, users.full_name AS users_full_name, users.city AS users_city, users.desired_position AS users_desired_position, users.skills AS users_skills, users.base_resume AS users_base_resume, users.created_at AS users_created_at, users.is_active AS users_is_active 
FROM users 
WHERE users.telegram_id = %(telegram_id_1)s 
 LIMIT %(param_1)s
2025-11-25 11:10:34 - sqlalchemy.engine.Engine - INFO - [cached since 70.98s ago] {'telegram_id_1': '938253913', 'param_1': 1}
2025-11-25 11:10:34 - sqlalchemy.engine.Engine - INFO - SELECT llm_settings.id AS llm_settings_id, llm_settings.user_id AS llm_settings_user_id, llm_settings.base_url AS llm_settings_base_url, llm_settings.api_key AS llm_settings_api_key, llm_settings.model_name AS llm_settings_model_name, llm_settings.created_at AS llm_settings_created_at, llm_settings.updated_at AS llm_settings_updated_at 
FROM llm_settings 
WHERE llm_settings.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
2025-11-25 11:10:34 - sqlalchemy.engine.Engine - INFO - [generated in 0.00185s] {'user_id_1': 4, 'param_1': 1}
2025-11-25 11:10:35 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-11-25 11:10:35 - aiogram.event - INFO - Update id=587740993 is handled. Duration 1108 ms by bot id=7721173847
2025-11-25 11:21:18 - aiogram.dispatcher - INFO - Polling stopped
2025-11-25 11:21:18 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-11-25 11:21:18 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7721173847)
2025-11-25 11:21:18 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-11-25 11:21:18 - aiogram.dispatcher - INFO - Polling stopped for bot @HH_work_day_bot id=7721173847 - 'HH_work_day_bot'
